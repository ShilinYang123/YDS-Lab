# 数字员工项目虚拟环境使用手册

## 📚 概述

本手册详细介绍数字员工项目虚拟环境方案的使用方法，适用于编程小白和非专业用户。该方案去除了Docker依赖，采用原生Windows服务，提供更简单、更直观的部署体验。

## 🎯 适用人群

- 编程初学者
- Windows系统用户
- 不喜欢命令行操作的用户
- 需要快速搭建开发环境的开发者
- 对Docker不熟悉的用户

## 🚀 快速开始

### 1. 一键安装

```batch
# 双击运行setup.bat
setup.bat
```

安装程序会自动：
- ✅ 检查系统环境
- ✅ 下载必要组件
- ✅ 安装PostgreSQL数据库
- ✅ 安装Redis缓存服务
- ✅ 安装MinIO对象存储
- ✅ 配置Python虚拟环境
- ✅ 创建管理脚本

### 2. 一键启动

```batch
# 双击运行start.bat
start.bat
```

### 3. 一键停止

```batch
# 双击运行stop.bat
stop.bat
```

### 4. 查看状态

```batch
# 双击运行status.bat
status.bat
```

## 📁 项目结构

```
digital-employee/
├── 📂 services/          # 服务程序目录
│   ├── 📂 postgresql/    # PostgreSQL数据库
│   ├── 📂 redis/         # Redis缓存服务
│   └── 📂 minio/         # MinIO对象存储
├── 📂 scripts/           # 管理脚本
│   ├── 📂 install/       # 安装脚本
│   ├── 📂 manage/        # 管理脚本
│   └── 📂 check/         # 检查脚本
├── 📂 config/            # 配置文件
│   ├── 📂 services/      # 服务配置
│   └── 📂 environment/   # 环境变量
├── 📂 data/              # 数据文件
│   ├── 📂 postgres/      # 数据库数据
│   ├── 📂 redis/         # 缓存数据
│   └── 📂 minio/         # 对象存储数据
├── 📂 logs/               # 日志文件
├── 📂 python-env/        # Python虚拟环境
├── 📂 backend/           # 后端代码
├── 📂 frontend/          # 前端代码
└── 📂 docs/              # 项目文档
```

## 🔧 详细使用指南

### 环境要求

| 项目 | 最低要求 | 推荐配置 |
|------|----------|----------|
| 操作系统 | Windows 10 | Windows 11 |
| CPU | 4核心 | 8核心 |
| 内存 | 8GB | 16GB |
| 磁盘空间 | 20GB | 50GB |
| Python | 3.8+ | 3.11+ |
| Node.js | 18+ | 20+ |

### 安装步骤

#### 步骤1：环境检查

运行环境检查脚本：
```batch
scripts\check\check-env.bat
```

脚本会检查：
- ✅ 系统版本和架构
- ✅ 内存和磁盘空间
- ✅ Python环境
- ✅ Node.js环境
- ✅ 端口占用情况

#### 步骤2：执行安装

**方法一：一键安装（推荐）**
```batch
setup.bat
```

**方法二：分步安装**
```batch
# 安装PostgreSQL
scripts\install\install-postgres.bat

# 安装Redis
scripts\install\install-redis.bat

# 安装MinIO
scripts\install\install-minio.bat
```

#### 步骤3：验证安装

检查服务状态：
```batch
status.bat
```

### 服务管理

#### 启动服务

**启动所有服务：**
```batch
start.bat
```

**单独启动某个服务：**
```batch
# 启动PostgreSQL
cd services\postgresql
start-postgres.bat

# 启动Redis
cd services\redis
start-redis.bat

# 启动MinIO
cd services\minio
start-minio.bat
```

#### 停止服务

**停止所有服务：**
```batch
stop.bat
```

**单独停止某个服务：**
```batch
# 停止PostgreSQL
cd services\postgresql
stop-postgres.bat

# 停止Redis
cd services\redis
stop-redis.bat

# 停止MinIO
cd services\minio
stop-minio.bat
```

#### 检查状态

**查看所有服务状态：**
```batch
status.bat
```

**查看特定服务状态：**
```batch
# PostgreSQL状态
cd services\postgresql
status-postgres.bat

# Redis状态
cd services\redis
status-redis.bat

# MinIO状态
cd services\minio
status-minio.bat
```

### 访问管理界面

| 服务 | 地址 | 默认账号 | 用途 |
|------|------|----------|------|
| PostgreSQL管理 | http://localhost:5050 | admin@example.com / admin123 | 数据库管理 |
| Redis管理 | http://localhost:8081 | 无需登录 | 缓存管理 |
| MinIO控制台 | http://localhost:9001 | minioadmin / minioadmin123 | 对象存储管理 |
| 应用主页 | http://localhost:3000 | 根据应用配置 | 主应用界面 |
| API文档 | http://localhost:3001/docs | 无需登录 | API接口文档 |

## ⚙️ 配置管理

### 环境变量配置

配置文件位置：`config\environment\`

- `development.env` - 开发环境配置
- `production.env` - 生产环境配置
- `local.env` - 本地环境配置

### 服务配置

服务配置文件位置：`config\services\`

- `postgresql.conf` - PostgreSQL配置
- `redis.conf` - Redis配置
- `minio.conf` - MinIO配置

### 修改配置

1. **停止相关服务**
2. **编辑配置文件**
3. **重启服务**

## 📊 监控和维护

### 日志查看

日志文件位置：`logs\`

```batch
# 查看最近的日志
type logs\service-start.log

# 查看PostgreSQL日志
type logs\postgres\postgresql-*.log

# 查看Redis日志
type logs\redis\redis.log

# 查看MinIO日志
type logs\minio\minio.log
```

### 性能监控

**查看资源使用：**
```batch
# 查看CPU和内存使用
tasklist

# 查看端口监听
netstat -ano

# 查看磁盘使用
dir
```

### 数据备份

**数据库备份：**
```batch
# PostgreSQL备份
cd services\postgresql
pg_dump.exe -h localhost -U postgres digital_employee_dev > backup.sql
```

**Redis备份：**
```batch
# Redis数据在 data\redis\ 目录
# 复制dump.rdb文件即可
```

**MinIO备份：**
```batch
# MinIO数据在 data\minio\ 目录
# 复制整个目录即可
```

## 🔧 故障排除

### 常见问题

#### 1. 端口被占用

**问题描述：**
启动时提示端口已被占用

**解决方案：**
```batch
# 查看端口占用
netstat -ano | findstr ":5432"

# 结束占用进程
taskkill /PID 进程ID /F
```

#### 2. 服务启动失败

**问题描述：**
某个服务无法启动

**排查步骤：**
1. 查看日志文件
2. 检查配置文件
3. 验证端口状态
4. 重新安装服务

#### 3. 数据库连接失败

**问题描述：**
无法连接到PostgreSQL

**解决方案：**
1. 检查PostgreSQL服务状态
2. 验证用户名密码
3. 检查防火墙设置
4. 查看PostgreSQL日志

#### 4. 内存不足

**问题描述：**
系统提示内存不足

**解决方案：**
1. 关闭不必要的程序
2. 增加虚拟内存
3. 升级物理内存
4. 调整服务配置

### 日志分析

**查看错误日志：**
```batch
# 搜索错误信息
findstr "ERROR" logs\*.log

# 搜索警告信息
findstr "WARN" logs\*.log

# 查看特定时间日志
findstr "2024-01-01" logs\*.log
```

### 重新安装

**卸载项目：**
```batch
uninstall.bat
```

**重新安装：**
```batch
setup.bat
```

## 💡 最佳实践

### 1. 定期维护

- ✅ 定期清理日志文件
- ✅ 定期备份数据
- ✅ 监控磁盘空间
- ✅ 更新服务版本

### 2. 安全建议

- 🔒 修改默认密码
- 🔒 限制网络访问
- 🔒 定期更新补丁
- 🔒 启用防火墙

### 3. 性能优化

- 🚀 使用SSD硬盘
- 🚀 增加内存容量
- 🚀 优化数据库配置
- 🚀 启用缓存策略

### 4. 开发建议

- 💻 使用VS Code编辑器
- 💻 配置代码格式化
- 💻 使用Git版本控制
- 💻 编写单元测试

## 📞 技术支持

### 自助排错

1. **查看日志文件**
2. **运行状态检查**
3. **搜索已知问题**
4. **重新启动服务**

### 获取帮助

- 📖 查看项目文档：`docs\`
- 🔍 搜索错误信息
- 💬 社区支持
- 📧 技术支持邮箱

### 报告问题

报告问题时请提供：
- ✅ 操作系统版本
- ✅ 错误描述
- ✅ 相关日志
- ✅ 重现步骤

## 📋 版本历史

| 版本 | 日期 | 更新内容 |
|------|------|----------|
| v1.0.0 | 2024-01-01 | 初始版本，支持基础服务 |
| v1.1.0 | 2024-02-01 | 增加一键安装脚本 |
| v1.2.0 | 2024-03-01 | 优化错误处理 |
| v1.3.0 | 2024-04-01 | 增加图形化界面 |

---

**💝 祝您使用愉快！**

如有问题，请参考故障排除章节或寻求技术支持。