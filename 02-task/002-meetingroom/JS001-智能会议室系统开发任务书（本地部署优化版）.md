# JS001 - 智能会议室系统开发任务书（V2.1｜Trae MCP适配版）

**项目编号**：JS001  
**版本**：V2.1（Trae MCP适配版）  
**更新日期**：2025-11-15  
**适配平台**：Trae智能开发平台  
**架构版本**：YDS-Lab V5.1目录结构  
**文档状态**：修订版（统一版本，收敛V1.0/V1.1/V2.0与实时增补）

---

## 1. 项目概述与战略一致性

YDS-Lab智能会议室系统用于支持“一个人 + 一群智能体”的混合协作，满足公司内外部会议的高效管理与治理需要。

- 对齐公司治理理念：阴阳双核（董事长/总经理）与五行部门（木/火/土/金/水）协同，术语统一为“智能体、虚拟会议室、议程、意见表达、分歧处理、投票、纪要、决策追溯”。
- 对齐实施方案：采用“异步协作 + 关键节点同步”的会议机制，建立类人化讨论能力，支持分歧识别与投票决策，并保留决策追溯与学习。

## 2. 需求范围

### 2.1 功能需求
- 会议预约与分级：A级（战略）、B级（业务）、C级（日常）
- 虚拟会议室：文本通道、语音通道（后续）、文档共享、投票机制
- 议程管理：自动生成、优先级排序、时长控制、主持与控场
- 意见表达与分歧处理：🟢🟡🔴🔵分类与处理流程
- 会议纪要与决策追溯：纪要生成、行动项提取、决策数据入库
- 任务提取与分配：基于角色与权限的自动分配与进度跟踪

### 2.2 非功能需求
- 性能：页面加载≤2s，操作响应≤1s；并发≥20人
- 稳定性：系统可用性≥99.5%
- 安全与合规：JWT鉴权、RBAC、ACL、审计留痕与留存策略
- 兼容性：Chrome/Firefox/Safari/Edge；Windows本地部署优先

## 3. 技术架构与Trae MCP适配

### 3.1 统一消息模型
```json
{
  "id": "msg-2025-11-03-0001",
  "room_id": "room-2025-001",
  "channel": "text | voice | docs | vote",
  "event_type": "message.text | voice.stream | docs.share | vote.cast",
  "topic": "rooms/{room_id}/{channel}/{event_type}",
  "sender": { "id": "agent.ceo", "role": "CEO", "display_name": "总经理智能体" },
  "timestamp": "2025-11-03T09:30:10Z",
  "payload": {
    "text": { "content": "讨论要点……" },
    "voice": { "session_id": "voice-abc", "chunk_seq": 1, "sample_rate": 16000, "format": "pcm16", "data_base64": "..." },
    "docs": { "action": "share", "path": "s:\\YDS-Lab\\01-struc\\SharedWorkspace\\Documents\\MeetingAttachments\\demo.pdf", "name": "demo.pdf", "type": "pdf", "size": 12345, "hash": "sha256:...", "permissions": "read" },
    "vote": { "proposal_id": "vote-001", "options": ["A", "B"], "selected": "A", "anonymous": false, "weight": 1, "quorum": 0.6, "expires_at": "2025-11-03T10:00:00Z" }
  }
}
```

说明：payload为“按需”的并集结构，随channel取其子对象；客户端与服务端校验`event_type`与`payload`一致性。

### 3.2 端点与路由
```
WebSocket: /ws?token=...
  事件: message.text | voice.stream | docs.share | vote.cast | system.notice
  Topic: rooms/{room_id}/{channel}/{event_type}

REST 控制面:
  POST /mcp/messages/send
  POST /mcp/docs/share | GET /mcp/docs/list
  POST /mcp/votes/create | POST /mcp/votes/cast | GET /mcp/votes/status
  POST /mcp/voice/session/start | POST /mcp/voice/chunk
```

### 3.3 通道与集成策略
- 文本通道：Socket 封装统一消息；UI 实时呈现与留痕。
- 文档通道：受白名单/黑名单与RBAC控制；共享/撤回可审计。
- 投票通道：支持匿名/权重/quorum；结果入纪要与追溯。
- 语音通道：分片顺序传输，服务端重组与STT，弱网重传与校验；云端不可用回退至本地。
- 实时降级通道：保留现有`/api/rtm/*`（SSE）作为轻量降级，与WS主链路可互通并提供迁移说明。

## 4. 实施计划与里程碑（V5.1对齐）

- 第一阶段（基础搭建期，1-3个月）：搭建WS/REST主链路、统一消息模型、共享工作区与权限初版。
- 第二阶段（试点验证期，4-6个月）：以真实项目验证会议分级、分歧处理、投票闭环与治理性测试。
- 第三阶段（规模运营期，7-9个月）：沉淀行业模板与知识库，构建客户满意度监控机制。
- 第四阶段（优化升级期，10-12个月）：效率与会议质量提升、扩展智能体能力与工具集成。

## 5. 验收标准（节选）

- 功能：预约/议程/文本聊天/文档共享/投票/纪要/任务提取完成度≥100%。
- 性能：启动<30s，页面<5s，单轮响应<10s。
- 稳定：连续运行24h无崩溃，CPU<80%峰值，GPU<90%峰值。
- 安全：鉴权与权限控制通过；敏感目录共享拒绝。

## 6. 风险评估与应对

- 显存与性能：采用轻量模型、量化、CPU+GPU混合、上下文与输出长度限制。
- 进度延迟：优先实现核心功能，非核心功能分阶段补充。
- 治理缺失：引入白/黑名单、RBAC与审计机制；治理测试纳入验收。

## 7. 版本与附录（占位）

- 版本变更记录：收敛旧版本为条目，新增V2.1。
- 附录：术语对照、错误码与鉴权失败处理、关键配置样例与健康检查命令。

---

> 注：后续章节将补充“权限与审计、文档共享治理、语音服务部署与健康检查、测试与KPI、会议机制与决策追溯、版本变更记录与附录”细则。

## 8. 权限与审计（MVP）

- 身份认证：统一采用JWT；在WebSocket握手与REST控制面请求中校验`token`。
- RBAC角色：CEO、会议秘书、财务总监、技术代表、观察员；按角色授予通道级操作权限。
- 资源级ACL：引入路径白名单与黑名单；“合同原件/对外正式原稿”禁止共享，仅允许摘要只读引用。
- 审计留痕：记录操作者、时间、资源路径、校验结果；输出至`s:\YDS-Lab\01-struc\logs\audit_trails`；日志按月归档与压缩。

```yaml
rbac:
  roles: [CEO, MeetingSecretary, FinanceDirector, TechRepresentative, Observer]
acl:
  resources:
    - name: meeting_attachments
      paths: ["s:\\YDS-Lab\\01-struc\\SharedWorkspace\\Documents\\MeetingAttachments\\**"]
      permissions: [read, write, share]
      roles: [CEO, MeetingSecretary]
    - name: collaboration_docs
      paths: ["s:\\YDS-Lab\\01-struc\\SharedWorkspace\\Collaboration\\**"]
      permissions: [read, write]
      roles: [CEO, MeetingSecretary, TechRepresentative]
    - name: strategic_docs_readonly
      paths: ["s:\\YDS-Lab\\01-struc\\companydocs\\YDS-AI-战略规划\\*.md"]
      permissions: [read]
      roles: [CEO, MeetingSecretary, FinanceDirector, TechRepresentative, Observer]
    - name: contracts_forbidden
      paths: ["s:\\YDS-Lab\\01-struc\\companydocs\\**\\合同\\**"]
      permissions: []
      roles: [CEO, MeetingSecretary, FinanceDirector, TechRepresentative, Observer]
audit:
  output: "s:\\YDS-Lab\\01-struc\\logs\\audit_trails"
  retain_days: 180
```

## 9. 文档共享治理与目录白名单

- 分类与用途边界：机密类（只读摘要）、共享类（会议附件与协作文档主目录）、对外展示类（公开物料与演示素材）。
- 允许目录（白名单）：
  1) `s:\YDS-Lab\01-struc\SharedWorkspace\Documents\MeetingAttachments\**`（读/写/共享）
  2) `s:\YDS-Lab\01-struc\SharedWorkspace\Collaboration\**`（读/写/协作）
  3) `S:\YDS-Lab\04-prod\deliverables\011-showcase-materials\assets\**`（只读共享）
  4) `s:\YDS-Lab\01-struc\companydocs\YDS-AI-战略规划\*.md`（只读引用，禁止导出原稿）
- 默认禁止：`s:\YDS-Lab\01-struc\companydocs\**\合同\**`与名称包含`合同/对外文档`的路径（需提交“去敏摘要”到共享目录后再引用）。

## 10. 语音服务部署与健康检查

- 环境与路径：建议设置`SHIMMY_HOME = s:\\LLM\\models\\shimmy`；将`shimmy.exe`加入PATH；Ollama默认端口`11434`，Shimmy端口建议`51080`。
- external_models.json 映射（示例）：

```json
{
  "stt": {
    "default": "shimmy.whisper-tiny-zh",
    "providers": {
      "shimmy": { "host": "http://127.0.0.1:51080", "models": ["whisper-tiny-zh", "whisper-small-zh"] }
    }
  },
  "tts": {
    "default": "shimmy.onnx-zh",
    "providers": {
      "shimmy": { "host": "http://127.0.0.1:51080", "voices": ["zh_female", "zh_male"] }
    }
  },
  "llm": {
    "default": "ollama.qwen2.5",
    "providers": {
      "ollama": { "host": "http://127.0.0.1:11434", "models": ["qwen2.5:latest", "llama3.1:8b"] }
    }
  }
}
```

- 健康检查：
  - `Invoke-WebRequest http://127.0.0.1:11434/api/tags`
  - `Invoke-WebRequest http://127.0.0.1:51080/health`
- 语音链路参数建议：分片大小32–64KB；采样率16k；格式PCM16；弱网重传与分片校验；云端不可用自动回退本地。

## 11. 测试与验收清单（治理驱动）

1) 权限拒绝与白/黑名单：共享`companydocs`下合同原件应被拒绝；共享`MeetingAttachments`通过，并留痕。  
2) 投票闭环：投票创建→投票→计票→结果广播→纪要入库，含匿名与法定人数（quorum）校验。  
3) 文档共享一致性：并发共享时，消息与UI状态一致，撤回生效且可审计。  
4) 语音链路端到端：弱网条件下分片重传与转写质量；本地（Shimmy）与云端切换策略验证。  
5) 会议纪要质量：文本汇总、行动项与决策记录完整性；关键事件回放索引可用。

## 12. KPI与评估指标对齐

- 效率指标：项目平均交付周期≤15天；会议决策效率≤30分钟/决策；智能体协作自动化率≥85%。
- 质量指标：项目验收通过率≥90%；决策准确率≥85%；代码质量评分≥8.5/10。
- 协作指标：跨部门协作满意度≥90%；会议参与度≥95%；意见分歧解决率≥90%。
- 学习指标：智能体能力提升率≥20%/季度；最佳实践沉淀数量≥10个/月；流程优化频率≥2次/月。

## 13. 会议机制与决策追溯

- 会议分级：
  - A级（战略）：60–90分钟；充分讨论+投票表决；月度或按需。
  - B级（业务）：30–45分钟；专业讨论+共识达成；周度或按需。
  - C级（日常）：15–30分钟；快速讨论+行动确认；日度或按需。
- 意见表达与分歧处理：🟢认同、🟡部分认同、🔴不同意、🔵需要更多信息；分歧识别→深度讨论→数据支撑→第三方意见→投票→决策记录。
- 决策追溯结构：
```json
{
  "decision_id": "DEC_2025_001",
  "meeting_info": {"date": "2025-01-15", "type": "B级会议", "participants": ["CEO_Agent", "Tech_Coordinator", "CFO_Agent"], "duration": "45分钟"},
  "decision_content": {"topic": "技术方案选择", "options": ["A", "B"], "final_decision": "A", "reasoning": "长期收益更高"},
  "discussion_process": {"opinions": [], "resolution": "基于ROI与市场数据"},
  "action_items": [{"task": "模型选型", "assignee": "Backend_Developer_Agent", "deadline": "2025-01-20"}]
}
```

## 14. 版本变更记录

- 2025-10-23：发布V1.0基线；同日补充V1.1第一阶段快速启动。
- 2025-10-23：发布V2.0（本地部署优化版）。
- 2025-10-28：增补“实时会议模式（本地部署）”。
- 2025-11-15：发布V2.1（Trae MCP适配版）：统一消息模型、WS/REST端点、RBAC与ACL、白名单治理、语音服务与健康检查、治理性测试与KPI、会议机制与决策追溯，统一术语与版本收敛。

## 15. 附录

- 术语对照表：AI Agent→智能体；Meeting Room→虚拟会议室；Minutes→会议纪要；Decision Tracking→决策追溯。
- 接口错误码：401未认证、403无权限、422参数错误、429限流、500服务器错误；错误返回统一封装。
- 健康检查命令：`Invoke-WebRequest http://127.0.0.1:11434/api/tags`；`Invoke-WebRequest http://127.0.0.1:51080/health`。